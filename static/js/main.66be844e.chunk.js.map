{"version":3,"sources":["components/Trainer.module.css","components/Card.module.css","modules/steps.ts","components/Card.tsx","tools/array.ts","modules/icons.tsx","hooks/useNoSleep.ts","components/PartialCircle.tsx","hooks/usePausableTimeout.ts","tools/time.ts","components/Trainer.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["module","exports","steps","title","items","timeSec","repeatCount","subtitle","group","step","push","data","VibrateType","arrayWithLength","length","array","Array","i","playIconHtml","__html","pauseIconHtml","nextIconHtml","noSleep","NoSleep","requestersCount","createNoSleepClient","isEnabled","enable","disable","svgStyle","transform","PartialCircle","part","size","strokeWidth","normalizedSize","halfNormalizedSize","halfSize","strokeDasharray","useMemo","Math","PI","width","height","viewBox","style","r","cx","cy","fill","stroke","strokeLinecap","Card","isActive","stepIndex","stepsCount","goCard","useState","isPaused","setPaused","isFreezeBeforePlay","setFreezeBeforePlay","isActiveLatest","useLatest","useEffect","useNoSleep","update","useUpdate","useInterval","currentTime","Date","now","startTime","useRef","pausedTime","current","useCallback","time","usePausableTimeout","currentTimeFromStart","resetTimer","setStarted","cycleTimingsMs","dataItems","timings","oneCycleTimeMs","repeatDone","floor","thisTurnTime","activeStep","useItemWithNearestLessValue","thisStepTime","isStarted","isStartedLatest","isEnded","tryVibrate","Short","Double","stepItems","repeatItems","handleStartPause","setTimeout","handleGoNext","min","className","css","root","stepsList","map","_","index","classNames","stepsItem","item_active","undefined","item","isActiveItem","timeCircle","timeCircle_full","itemTitle_active","repeatItem","repeatItem_done","playPauseButton","dangerouslySetInnerHTML","onClick","playPauseButton_freezed","type","navigator","vibrate","value","sortedAscArray","prevIntervalAndResult","currentData","getItemIndexWithNearestLessValue","animationConifg","friction","tension","Trainer","windowSize","useWindowSize","defaultOffset","pixelsInRem","getPos","rawX","down","x","newX","widthPart","newZ","max","useSprings","config","animationProps","setAnimationProps","setStepIndex","bind","useDrag","movement","abs","direction","newIndex","axis","filterTaps","revI","div","card","interpolate","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.66be844e.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Trainer_root__2D0FO\",\"card\":\"Trainer_card__QlvSl\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Card_root__3MkF8\",\"stepsList\":\"Card_stepsList__1NQhJ\",\"stepsItem\":\"Card_stepsItem__IlQTM\",\"item_active\":\"Card_item_active__3ytBQ\",\"title\":\"Card_title__1yJ7t\",\"subtitle\":\"Card_subtitle__1lNmV\",\"data\":\"Card_data__3UBEy\",\"item\":\"Card_item__1z5IU\",\"time\":\"Card_time__3t47b\",\"timeCircle\":\"Card_timeCircle__2Vauv\",\"timeCircle_full\":\"Card_timeCircle_full__3diLc\",\"itemTitle_active\":\"Card_itemTitle_active__2xQqC\",\"repeatCount\":\"Card_repeatCount__2eZHW\",\"repeatItem\":\"Card_repeatItem__3-1q1\",\"repeatItem_done\":\"Card_repeatItem_done__3XRSg\",\"prevNext\":\"Card_prevNext__114Pb\",\"playPauseButton\":\"Card_playPauseButton__5TABC\",\"playPauseButton_freezed\":\"Card_playPauseButton_freezed__YTSMx\"};","const stepGroups = [{\n  title: \"Сидеть\",\n  steps: [\n    {\n      items: [\n        {\n          title: \"Зажмурится\",\n          timeSec: 4\n        },\n        {\n          title: \"Разомкнуть веки\",\n          timeSec: 4\n        },\n      ],\n      repeatCount: 8\n    },\n    {\n      items: [\n        {\n          title: \"Быстро моргать\",\n          timeSec: 15\n        },\n        {\n          title: \"Закрыть глаза\",\n          timeSec: 10\n        },\n      ],\n      repeatCount: 4\n    },\n    {\n      items: [{\n        title: \"Массировать указательными пальцами\",\n        timeSec: 60\n      }],\n      repeatCount: 1\n    },\n    {\n      items: [{\n        title: \"Лёгкие надавливающие движения\",\n        timeSec: 3\n      }, {\n        title: \"Отдых\",\n        timeSec: 3\n      }],\n      repeatCount: 4\n    }\n  ]\n},\n{\n  title: \"Ровно сидеть\",\n  steps: [\n    {\n      items: [{\n        title: \"Вверх-вниз\",\n        timeSec: 3\n      }],\n      repeatCount: 12\n    },\n    {\n      items: [{\n        title: \"Влево-вправо\",\n        timeSec: 3\n      }],\n      repeatCount: 12\n    },\n    {\n      items: [{\n        title: \"Вверх-вниз, влево-вправо\",\n        timeSec: 6\n      }],\n      repeatCount: 10\n    },\n    {\n      items: [{\n        title: \"Вращение по и против часовой\",\n        timeSec: 3\n      }],\n      repeatCount: 6\n    }\n  ]\n},\n{\n  title: \"Стоять\",\n  steps: [\n    {\n      items: [\n        {\n          title: \"Стена\",\n          timeSec: 3\n        },\n        {\n          title: \"Палец 30 см от глаз\",\n          timeSec: 5\n        }\n      ],\n      repeatCount: 12\n    },\n    {\n      items: [{\n        title: \"Палец на вытянутой руке: cмотреть и приближать до двоения\",\n        timeSec: 4\n      }],\n      repeatCount: 8\n    },\n  ]\n},\n{\n  // TODO special page!\n  title: \"Стоять у окна\",\n  subtitle: \"Метка на окне, объект в дали. По 3 секунды\",\n  steps: [\n    {\n      items: [{\n        title: \"Левый глаз\",\n        timeSec: 120\n      }, {\n        title: \"Оба глаза\",\n        timeSec: 120\n      }, {\n        title: \"Правый глаз\",\n        timeSec: 120\n      }],\n      repeatCount: 1\n    }\n  ]\n}];\n\nexport type LinearizedStep = {\n  title: string;\n  subtitle?: string;\n  repeatCount: number;\n  data: {\n    items: {\n      title: string;\n      timeSec: number;\n    }[];\n  };\n};\n\nexport const steps: LinearizedStep[] = [];\n\nfor (const group of stepGroups) {\n  for (const step of group.steps) {\n    steps.push({\n      title: group.title,\n      subtitle: group.subtitle,\n      repeatCount: step.repeatCount,\n      data: step\n    });\n  }\n}\n","import { FC, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport classNames from 'classnames';\nimport { useLatest } from 'react-use';\n\nimport css from './Card.module.css';\nimport { secToString } from '../tools/time';\nimport { arrayWithLength } from '../tools/array';\nimport { LinearizedStep } from '../modules/steps';\nimport { usePausableTimeout } from '../hooks/usePausableTimeout';\nimport { nextIconHtml, pauseIconHtml, playIconHtml } from '../modules/icons';\nimport { useNoSleep } from '../hooks/useNoSleep';\nimport { PartialCircle } from './PartialCircle';\nimport { pixelsInRem } from '../common';\n\nconst strokeWidthTimeCircle = 4;\n\nenum VibrateType {\n  Short,\n  Double\n}\n\ntype CardProps = {\n  isActive: boolean;\n  stepIndex: number;\n  stepsCount: number;\n  step: LinearizedStep;\n  goCard(index: number): void;\n};\n\nexport const Card: FC<CardProps> = ({ isActive, step, stepIndex, stepsCount, goCard }) => {\n  const [isPaused, setPaused] = useState(true);\n  const [isFreezeBeforePlay, setFreezeBeforePlay] = useState(false);\n  const isActiveLatest = useLatest(isActive);\n  const noSleep = useNoSleep();\n\n  const [currentTimeFromStart, resetTimer] = usePausableTimeout(isPaused);\n\n  useEffect(() => {\n    if (!isActive) {\n      setPaused(true);\n      setStarted(false);\n      resetTimer();\n      noSleep.disable();\n    }\n  }, [isActive, noSleep, resetTimer]);\n\n  const cycleTimingsMs = useMemo(() => {\n    const dataItems = step.data.items;\n\n    const timings = [0];\n    for (let i = 1; i < dataItems.length; i++) {\n      timings.push(timings[i-1] + (dataItems[i].timeSec * 1000));\n    }\n    return timings;\n  }, [step.data.items]);\n\n  const oneCycleTimeMs = cycleTimingsMs[cycleTimingsMs.length - 1] + step.data.items[cycleTimingsMs.length - 1].timeSec * 1000;\n\n  const repeatDone = Math.floor(currentTimeFromStart / oneCycleTimeMs);\n  const thisTurnTime = currentTimeFromStart - repeatDone * oneCycleTimeMs;\n\n  const activeStep = useItemWithNearestLessValue(thisTurnTime, cycleTimingsMs);\n  const thisStepTime = thisTurnTime - (activeStep === -1 ? 0 : cycleTimingsMs[activeStep]);\n  const [isStarted, setStarted] = useState(false);\n  const isStartedLatest = useLatest(isStarted);\n  const isEnded = repeatDone >= step.repeatCount;\n\n  useEffect(() => {\n    if (isStartedLatest.current && !isEnded) {\n      tryVibrate(VibrateType.Short);\n    }\n  }, [isStartedLatest, isEnded, repeatDone, activeStep]); // activeStep, repeatDone needs for vibrate every time when step changed\n\n  useEffect(() => {\n    if (isEnded) {\n      tryVibrate(VibrateType.Double);\n      setPaused(true);\n      noSleep.disable();\n    }\n  }, [isEnded, noSleep]);\n  \n  const stepItems = useMemo(\n    () => arrayWithLength(stepsCount),\n    [stepsCount]\n  );\n\n  const repeatItems = useMemo(\n    () => arrayWithLength(step.repeatCount),\n    [step.repeatCount]\n  );\n\n  const handleStartPause = useCallback(() => {\n    // TODO show freeze in interface\n    setStarted(true);\n    if (isPaused) {\n      setFreezeBeforePlay(true);\n      noSleep.enable();\n      setTimeout(() => {\n        setFreezeBeforePlay(false);\n        if (isActiveLatest.current) {\n          setPaused(false);\n          tryVibrate(VibrateType.Short);\n        }\n      }, 1000);\n    } else {\n      setPaused(true);\n      noSleep.disable();\n    }\n  }, [isActiveLatest, isPaused, noSleep]);\n\n  const handleGoNext = useCallback(() => {\n    goCard(Math.min(stepsCount, stepIndex + 1));\n  }, [goCard, stepIndex, stepsCount]);\n\n  return (\n    <div className={css.root}>\n      <div className={css.stepsList}>\n        {stepItems.map((_, index) => (\n          <div\n            className={classNames(css.stepsItem, stepIndex >= index && css.item_active)}\n            key={index}\n          />\n        ))}\n      </div>\n      <div className={css.title}>\n        {step.title}\n      </div>\n      {step.subtitle !== undefined && (\n        <div className={css.subtitle}>\n          {step.subtitle}\n        </div>\n      )}\n      <div className={css.data}>\n        {step.data.items.map((item, index) => {\n          const isActiveItem = index === activeStep && isStarted && !isEnded;\n          return (\n            <div key={index} className={css.item}>\n              <div className={css.time}>\n                <div className={css.timeCircle}>\n                  <PartialCircle\n                    part={\n                      isActiveItem\n                        ? thisStepTime / 1000 / item.timeSec\n                        : isEnded || index < activeStep ? 1 : 0\n                    }\n                    size={2 * pixelsInRem + strokeWidthTimeCircle}\n                    strokeWidth={strokeWidthTimeCircle}\n                  />\n                </div>\n                <div className={classNames(css.timeCircle, css.timeCircle_full)}>\n                  <PartialCircle\n                    part={1}\n                    size={2 * pixelsInRem + strokeWidthTimeCircle}\n                    strokeWidth={strokeWidthTimeCircle}\n                  />\n                </div>\n                {secToString(item.timeSec)}\n              </div>\n              <div className={classNames(isActiveItem && css.itemTitle_active)}>\n                {item.title}\n              </div>\n            </div>\n          );\n        })}\n        {step.repeatCount !== 1 && (\n          <div className={css.item}>\n            <div className={css.repeatCount}>\n              x{step.repeatCount}\n            </div>\n            {repeatItems.map((_, index) => (\n              <div\n                key={index}\n                className={classNames(\n                  css.repeatItem,\n                  isStarted && index <= repeatDone && css.repeatItem_done\n                )}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n      {isEnded ? (\n        <button\n          className={css.playPauseButton}\n          dangerouslySetInnerHTML={nextIconHtml}\n          onClick={handleGoNext}\n        />\n      ) : (\n        <button\n          className={classNames(\n            css.playPauseButton,\n            isFreezeBeforePlay && css.playPauseButton_freezed\n          )}\n          dangerouslySetInnerHTML={isPaused ? playIconHtml : pauseIconHtml}\n          onClick={isFreezeBeforePlay ? undefined : handleStartPause}\n        />\n      )}\n    </div>\n  );\n};\n\nconst tryVibrate = (type: VibrateType) => {\n  if (navigator.vibrate) {\n    // If support\n    switch (type) {\n      case VibrateType.Short:\n        navigator.vibrate(50);\n        break;\n      case VibrateType.Double:\n        navigator.vibrate([50, 50, 50]);\n        break;\n    }\n  }\n}\n\ntype IntervalAndResult = {\n  array: number[];\n  index: number;\n};\n\nconst useItemWithNearestLessValue = (value: number, sortedAscArray: number[]): number => {\n  const prevIntervalAndResult = useRef<IntervalAndResult | null>(null);\n  const currentData = prevIntervalAndResult.current;\n  if (\n    currentData !== null\n    && currentData.array === sortedAscArray\n    && currentData.array[currentData.index] <= value\n    && (\n      currentData.index === currentData.array.length - 1\n      || currentData.array[currentData.index + 1] > value\n    )\n  ) {\n    return currentData.index;\n  }\n\n  const index = getItemIndexWithNearestLessValue(value, sortedAscArray);\n  prevIntervalAndResult.current = {\n    array: sortedAscArray,\n    index\n  };\n  \n  return index;\n};\n\nconst getItemIndexWithNearestLessValue = (value: number, sortedAscArray: number[]): number => {\n  for (let i = sortedAscArray.length - 1; i >= 0; i--) {\n    if (value >= sortedAscArray[i]) {\n      return i;\n    }\n  }\n  return -1;\n};","export const arrayWithLength = (length: number): null[] => {\n  const array = new Array(length);\n  for (let i = 0; i < length; i++) {\n    array[i] = null;\n  }\n  return array;\n}\n","const playIconString = '<svg viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M45 22.268C46.3333 23.0378 46.3333 24.9623 45 25.7321L15 43.0526C13.6667 43.8224 12 42.8601 12 41.3205L12 6.67949C12 5.13989 13.6667 4.17764 15 4.94744L45 22.268Z\" fill=\"currentColor\" /></svg>';\nconst pauseIconString = '<svg viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><rect x=\"12\" y=\"8\" width=\"8\" height=\"32\" rx=\"2\" fill=\"currentColor\"/><rect x=\"28\" y=\"8\" width=\"8\" height=\"32\" rx=\"2\" fill=\"currentColor\"/></svg>';\nconst nextIconString = '<svg viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M16.107 9.11944C15.2098 7.79117 16.1615 6 17.7644 6H21.7795C22.4439 6 23.065 6.32996 23.4369 6.88056L34.2439 22.8806C34.7007 23.5569 34.7007 24.4431 34.2439 25.1194L23.4369 41.1194C23.065 41.67 22.4439 42 21.7795 42H17.7644C16.1615 42 15.2098 40.2088 16.107 38.8806L25.4018 25.1194C25.8586 24.4431 25.8586 23.5569 25.4018 22.8806L16.107 9.11944Z\" fill=\"currentColor\"/></svg>';\n\nexport const playIconHtml = { __html: playIconString };\nexport const pauseIconHtml = { __html: pauseIconString };\nexport const nextIconHtml = { __html: nextIconString };","import NoSleep from 'nosleep.js';\nimport { useEffect, useState } from 'react';\n\nconst noSleep = new NoSleep();\n\nlet requestersCount = 0;\n\nconst createNoSleepClient = () => {\n  let isEnabled = false;\n\n  return {\n    enable() {\n      if (isEnabled) {\n        return;\n      }\n      isEnabled = true;\n      if (requestersCount === 0) {\n        noSleep.enable();\n      }\n      requestersCount++;\n    },\n    disable() {\n      if (!isEnabled) {\n        return;\n      }\n      isEnabled = false;\n      requestersCount--;\n      if (requestersCount === 0) {\n        noSleep.disable();\n      }\n    }\n  };\n}\n\nexport const useNoSleep = () => {\n  const [noSleep] = useState(createNoSleepClient);\n  useEffect(() => {\n    return () => {\n      noSleep.disable();\n    }\n  }, [noSleep]);\n\n  return noSleep;\n};\n","import { FC, useMemo } from \"react\";\n\ntype Props = {\n    part: number; // value in [0; 1]\n    size: number;\n    strokeWidth?: number;\n};\n\nconst svgStyle = { transform: \"rotate(-90deg)\" };\n\nexport const PartialCircle: FC<Props> = ({ part, size, strokeWidth = 2 }) => {\n  const normalizedSize = size - strokeWidth;\n  const halfNormalizedSize = normalizedSize / 2;\n  const halfSize = size / 2;\n  const strokeDasharray = useMemo(() => {\n    return `${part * Math.PI * normalizedSize} ${Math.PI * normalizedSize}`;\n  }, [part, normalizedSize]);\n\n  return (\n    <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`} style={svgStyle}>\n      {part !== 0 && (\n        <circle\n          r={halfNormalizedSize}\n          cx={halfSize}\n          cy={halfSize}\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth={strokeWidth}\n          strokeLinecap=\"round\"\n          strokeDasharray={strokeDasharray}\n        />\n      )}\n    </svg>\n  );\n};\n","import { useCallback, useEffect, useRef } from 'react';\nimport { useInterval, useUpdate } from 'react-use';\n\ntype UsePausableTimeoutReturn = [\n  timeFromStart: number,\n  reset: () => void\n]\n\nexport const usePausableTimeout = (isPaused: boolean): UsePausableTimeoutReturn => {\n  const update = useUpdate();\n  useInterval(update, isPaused ? null : 200);\n\n  const currentTime = Date.now();\n  const startTime = useRef(currentTime);\n  const pausedTime = useRef<number | null>(null);\n  \n  useEffect(() => {\n    if (isPaused) {\n      pausedTime.current = Date.now();\n    } else if (pausedTime.current !== null) {\n      startTime.current += Date.now() - pausedTime.current;\n      pausedTime.current = null;\n    }\n  }, [isPaused]);\n\n  const timeFromStart = (pausedTime.current ?? currentTime) - startTime.current;\n  const reset = useCallback(() => {\n    const time = Date.now();\n    startTime.current = time;\n    if (pausedTime.current !== null) {\n      pausedTime.current = time;\n    }\n  }, []);\n\n  return [timeFromStart, reset];\n};\n","export const secToString = (timeSec: number): string => {\n  if (timeSec < 60) {\n    return `${timeSec}s`;\n  }\n  return `${Math.floor(timeSec/60)}m`;\n}\n","import { FC, useCallback, useState } from 'react';\nimport { useDrag } from 'react-use-gesture';\nimport { animated, interpolate, useSprings } from 'react-spring';\n\nimport css from './Trainer.module.css';\nimport { steps } from '../modules/steps';\nimport { Card } from './Card';\nimport { useWindowSize } from 'react-use';\nimport { pixelsInRem } from '../common';\n\nconst animationConifg = {\n  friction: 50,\n  tension: 800 \n};\n\nexport const Trainer: FC = () => {\n  const windowSize = useWindowSize();\n  const defaultOffset = windowSize.width + pixelsInRem * 2;\n\n  const getPos = useCallback((index: number) => (rawX: number, down: number) => {\n    const x = (rawX + index) * defaultOffset;\n    const newX = x < 0 ? x : 0;\n    const widthPart = x / windowSize.width;\n    const newZ = x < 0 ? 1 : Math.max((1 - widthPart / 5), 0);\n    return `scale(${newZ - down * 0.1}) translateX(${newX}px)`;\n  }, [defaultOffset, windowSize.width]);\n\n  const [animationProps, setAnimationProps] = useSprings(steps.length, () => ({\n    x: 0,\n    down: 0,\n    config: animationConifg\n  }));\n\n  const [stepIndex, setStepIndex] = useState(0);\n\n  const goCard = (index: number) => {\n    setStepIndex(index);\n    setAnimationProps({ x: -index, down: 0 });\n  };\n\n  const bind = useDrag(({ down, movement: [x] }) => {\n    if (down) {\n      setAnimationProps({ x: (x / defaultOffset) - stepIndex, down: 1 });\n      return;\n    }\n\n    if (Math.abs(x) < (windowSize.width / 4)) {\n      setAnimationProps({ x: -stepIndex, down: 0 });\n      return;\n    }\n\n    const direction = x < 0 ? 1 : -1;\n    const newIndex = Math.max(0, Math.min(steps.length - 1, stepIndex + direction));\n    goCard(newIndex);\n  }, { axis: 'x', filterTaps: true });\n\n  return (\n    <div {...bind()} className={css.root}>\n      {animationProps.map(({ x, down }, revI) => {\n        const i = animationProps.length - revI - 1;\n\n        return (\n          <animated.div\n            key={i}\n            className={css.card}\n            style={{\n              transform: interpolate([x, down], getPos(i))\n            }}\n          >\n            <Card\n              isActive={i === stepIndex}\n              stepIndex={i}\n              stepsCount={steps.length}\n              step={steps[i]}\n              goCard={goCard}\n            />\n          </animated.div>\n        );\n      })}\n    </div>\n  );\n};\n","import { Trainer } from './components/Trainer';\n\nexport const App = () => {\n  return (\n    <Trainer />\n  );\n}\n\n\n/* <div>Работа над страницей в процессе...</div>\n      <div>\n        по материалам сайта{' '}\n        <a href='https://www.ochkov.net/informaciya/stati/kak-vypolnyat-lechebnuyu-gimnastiku-dlya-glaz-po-metodike-avetisova.htm'>\n          ochkov.net\n        </a>\n      </div> */","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { App } from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}